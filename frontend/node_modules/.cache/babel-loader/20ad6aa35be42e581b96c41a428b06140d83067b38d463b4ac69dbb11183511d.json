{"ast":null,"code":"import React,{useEffect,useState}from'react';import{dealAPI}from'../../services/dealAPI';import{groupAPI}from'../../services/groupAPI';import{toast}from'react-toastify';import PageHeader from'../../components/PageHeader';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Deals=()=>{const[allDeals,setAllDeals]=useState([]);const[myGroups,setMyGroups]=useState([]);const[loading,setLoading]=useState(true);useEffect(()=>{const fetchData=async()=>{try{const groupsData=await groupAPI.getMyGroups();setMyGroups(groupsData);const dealsData=await dealAPI.getAllDeals();const myGroupIds=groupsData.map(group=>group.id);const filteredDeals=dealsData.filter(deal=>myGroupIds.includes(deal.group_id));setAllDeals(filteredDeals);}catch(error){toast.error(error.detail||'Failed to fetch all deals');}finally{setLoading(false);}};fetchData();},[]);const getGroupDetails=groupId=>{return myGroups.find(group=>group.id===groupId)||{};};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center h-64\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-4 py-8 animate-fade-in\",children:[/*#__PURE__*/_jsx(PageHeader,{title:\"All My Deals\",subtitle:\"View all your deals here.\",showBackButton:true,backButtonPath:\"/customer/dashboard\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-6\",children:allDeals.length>0?allDeals.map(deal=>{var _group$product,_deal$total_amount;const group=getGroupDetails(deal.group_id);return/*#__PURE__*/_jsxs(\"div\",{className:\"border rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-shadow\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 border-b bg-gray-50\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"font-medium\",children:[\"Deal #\",deal.id]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500\",children:[\"Group #\",deal.group_id]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Product:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:((_group$product=group.product)===null||_group$product===void 0?void 0:_group$product.name)||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Total Amount:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-medium\",children:[\"\\u20B9\",((_deal$total_amount=deal.total_amount)===null||_deal$total_amount===void 0?void 0:_deal$total_amount.toFixed(2))||'0.00']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Members:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:deal.total_members||0})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Status:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 text-xs font-semibold rounded-full \".concat(deal.status==='completed'?'bg-green-100 text-green-800':deal.status==='cancelled'?'bg-red-100 text-red-800':'bg-yellow-100 text-yellow-800'),children:deal.status})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Created:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:new Date(deal.created_at).toLocaleDateString()})]}),deal.completed_at&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between mb-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Completed:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:new Date(deal.completed_at).toLocaleDateString()})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-4 bg-gray-50 border-t\",children:[deal.status==='pending'&&/*#__PURE__*/_jsx(\"div\",{className:\"text-center text-sm text-yellow-600\",children:\"Waiting for seller to complete this deal\"}),deal.status==='completed'&&/*#__PURE__*/_jsx(\"div\",{className:\"text-center text-sm text-green-600 font-semibold\",children:\"Order Completed! Your order has been confirmed.\"}),deal.status==='cancelled'&&/*#__PURE__*/_jsx(\"div\",{className:\"text-center text-sm text-red-600\",children:\"This deal was cancelled by the seller.\"})]})]},deal.id);}):/*#__PURE__*/_jsx(\"p\",{className:\"col-span-full text-center text-gray-500\",children:\"No deals found.\"})})]});};export default Deals;","map":{"version":3,"names":["React","useEffect","useState","dealAPI","groupAPI","toast","PageHeader","jsx","_jsx","jsxs","_jsxs","Deals","allDeals","setAllDeals","myGroups","setMyGroups","loading","setLoading","fetchData","groupsData","getMyGroups","dealsData","getAllDeals","myGroupIds","map","group","id","filteredDeals","filter","deal","includes","group_id","error","detail","getGroupDetails","groupId","find","className","children","title","subtitle","showBackButton","backButtonPath","length","_group$product","_deal$total_amount","product","name","total_amount","toFixed","total_members","concat","status","Date","created_at","toLocaleDateString","completed_at"],"sources":["E:/lockdeal/frontend/src/pages/customer/Deals.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { dealAPI } from '../../services/dealAPI';\nimport { groupAPI } from '../../services/groupAPI';\nimport { toast } from 'react-toastify';\nimport PageHeader from '../../components/PageHeader';\n\nconst Deals = () => {\n  const [allDeals, setAllDeals] = useState([]);\n  const [myGroups, setMyGroups] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const groupsData = await groupAPI.getMyGroups();\n        setMyGroups(groupsData);\n\n        const dealsData = await dealAPI.getAllDeals();\n        const myGroupIds = groupsData.map(group => group.id);\n        const filteredDeals = dealsData.filter(deal => myGroupIds.includes(deal.group_id));\n        setAllDeals(filteredDeals);\n      } catch (error) {\n        toast.error(error.detail || 'Failed to fetch all deals');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchData();\n  }, []);\n\n  const getGroupDetails = (groupId) => {\n    return myGroups.find(group => group.id === groupId) || {};\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex justify-center items-center h-64\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"container mx-auto px-4 py-8 animate-fade-in\">\n      <PageHeader title=\"All My Deals\" subtitle=\"View all your deals here.\" showBackButton={true} backButtonPath=\"/customer/dashboard\" />\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-6\">\n        {allDeals.length > 0 ? (\n          allDeals.map((deal) => {\n            const group = getGroupDetails(deal.group_id);\n            return (\n              <div key={deal.id} className=\"border rounded-lg overflow-hidden shadow-sm hover:shadow-md transition-shadow\">\n                <div className=\"p-4 border-b bg-gray-50\">\n                  <h3 className=\"font-medium\">Deal #{deal.id}</h3>\n                  <p className=\"text-sm text-gray-500\">Group #{deal.group_id}</p>\n                </div>\n                \n                <div className=\"p-4\">\n                  <div className=\"flex justify-between mb-2\">\n                    <span className=\"text-gray-600\">Product:</span>\n                    <span className=\"font-medium\">{group.product?.name || 'N/A'}</span>\n                  </div>\n                  \n                  <div className=\"flex justify-between mb-2\">\n                    <span className=\"text-gray-600\">Total Amount:</span>\n                    <span className=\"font-medium\">â‚¹{deal.total_amount?.toFixed(2) || '0.00'}</span>\n                  </div>\n                  \n                  <div className=\"flex justify-between mb-2\">\n                    <span className=\"text-gray-600\">Members:</span>\n                    <span className=\"font-medium\">{deal.total_members || 0}</span>\n                  </div>\n                  \n                  <div className=\"flex justify-between mb-2\">\n                    <span className=\"text-gray-600\">Status:</span>\n                    <span className={`px-2 py-1 text-xs font-semibold rounded-full ${\n                      deal.status === 'completed' ? 'bg-green-100 text-green-800' : \n                      deal.status === 'cancelled' ? 'bg-red-100 text-red-800' : \n                      'bg-yellow-100 text-yellow-800'\n                    }`}>\n                      {deal.status}\n                    </span>\n                  </div>\n                  \n                  <div className=\"flex justify-between mb-2\">\n                    <span className=\"text-gray-600\">Created:</span>\n                    <span className=\"font-medium\">{new Date(deal.created_at).toLocaleDateString()}</span>\n                  </div>\n                  \n                  {deal.completed_at && (\n                    <div className=\"flex justify-between mb-2\">\n                      <span className=\"text-gray-600\">Completed:</span>\n                      <span className=\"font-medium\">{new Date(deal.completed_at).toLocaleDateString()}</span>\n                    </div>\n                  )}\n                </div>\n                \n                <div className=\"p-4 bg-gray-50 border-t\">\n                  {deal.status === 'pending' && (\n                    <div className=\"text-center text-sm text-yellow-600\">\n                      Waiting for seller to complete this deal\n                    </div>\n                  )}\n                  \n                  {deal.status === 'completed' && (\n                    <div className=\"text-center text-sm text-green-600 font-semibold\">\n                      Order Completed! Your order has been confirmed.\n                    </div>\n                  )}\n                  \n                  {deal.status === 'cancelled' && (\n                    <div className=\"text-center text-sm text-red-600\">\n                      This deal was cancelled by the seller.\n                    </div>\n                  )}\n                </div>\n              </div>\n            );\n          })\n        ) : (\n          <p className=\"col-span-full text-center text-gray-500\">No deals found.</p>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Deals;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}